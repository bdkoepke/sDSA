# sDSA
Reverse engineering of Interactive Brokers sDSA application which is based on OCRA. Still need to extract the secrets from the sDSA application itself.

How to use:

Add your own key, password, and counter to sDSA.properties. You should be able to use the default ocraSuite unless IB changes it in the future. To get these values from your android device (there may be similar steps for iOS as well), place your phone in debugging mode and connect to it either wirelessly or through the usb debugging interface. Once that is done, open chrome/chromium (firefox may work as well but your on your own), and go to chrom://inspect. You should see your device listed under 'Devices'. You should also have the option to 'inspect' WebView in com.interactivebrokers.sdsa (37.0.0.0). If not then you need to open the sDSA application on your phone. Once you've done that change the web view to 'Sources' instead of 'Elements'. Go to file://androidasset/www/js/services/ocra.js and set a breakpoint (click the ruler on the left hand side) on the fist line after the declaration of the function OCRA.generateOCRA = function generateOCRA(ocraSuite, key, counter, question, password, sessionInformation, timeStamp). Then enter your PIN on the device and a known challenge so you can verify the process. The breakpoint should be hit and it should be possible to view the contents of ocraSuite, key, counter, and password. Record those values in the sDSA.properties file.

It is also possible to brute-force the PIN since they keyspace is so small, if you have a known-plaintext (ideally multiple known plaintexts). I'm not going to outline how to do that, but it appears to be pretty simple since the key and password are derived from a plaintext that is stored on the device concatenated with your PIN.

Again, the whole idea of this is so you can create your own, more secure hardware token without requiring $100,000 in equity with IB. It would also be possible to add this to ib controller, but I don't recommend doing that.
